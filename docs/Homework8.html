<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Noah W.K. Mattheis" />

<meta name="date" content="2025-03-19" />

<title>Homework8</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Noah Mattheis BIOL6100 Homework Hub</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="Homework.html">Homeworks</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Homework8</h1>
<h4 class="author">Noah W.K. Mattheis</h4>
<h4 class="date">2025-03-19</h4>

</div>


<div id="starting-with-our-data-set" class="section level4">
<h4>Starting with our data set:</h4>
<pre class="r"><code>z &lt;- read.table(&quot;synthetic_cannabis_use.csv&quot;,header=TRUE,sep=&quot;,&quot;)
z &lt;- subset(z, synth_days != 0)
str(z)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1743 obs. of  4 variables:
##  $ wave      : int  1 2 3 4 2 3 4 1 3 3 ...
##  $ iso       : chr  &quot;y&quot; &quot;y&quot; &quot;n&quot; &quot;y&quot; ...
##  $ synth_days: int  20 1 28 24 26 16 1 28 16 8 ...
##  $ subject_id: int  1 1 1 1 2 2 2 3 3 4 ...</code></pre>
<pre class="r"><code>summary(z)</code></pre>
<pre><code>##       wave           iso              synth_days      subject_id   
##  Min.   :1.000   Length:1743        Min.   : 1.00   Min.   :  1.0  
##  1st Qu.:1.000   Class :character   1st Qu.: 6.00   1st Qu.:149.0  
##  Median :2.000   Mode  :character   Median :19.00   Median :308.0  
##  Mean   :2.415                      Mean   :16.62   Mean   :303.5  
##  3rd Qu.:3.000                      3rd Qu.:28.00   3rd Qu.:451.5  
##  Max.   :4.000                      Max.   :28.00   Max.   :600.0</code></pre>
</div>
<div id="opening-library" class="section level4">
<h4>Opening Library</h4>
<pre class="r"><code>library(ggplot2) # for graphics
library(MASS) # for maximum likelihood estimation</code></pre>
</div>
<div id="reading-in-a-data-vector-for-testing-distributions"
class="section level4">
<h4>Reading in a data vector for testing distributions</h4>
<pre class="r"><code># quick and dirty, a truncated normal distribution to work on the solution set

# z &lt;- rnorm(n=3000,mean=0.2)
# z &lt;- data.frame(1:3000,z)
# names(z) &lt;- list(&quot;ID&quot;,&quot;synth_days&quot;)
# z &lt;- z[z$synth_days&gt;0,]
# str(z)
# summary(z$synth_days)</code></pre>
</div>
<div id="plot-histogram-of-data" class="section level4">
<h4>Plot Histogram of Data</h4>
<p>Plot a histogram of the data, using a modification of the code from
lecture. Here we are switching from qplot to ggplot for more graphics
options. We are also rescaling the y axis of the histogram from counts
to density, so that the area under the histogram equals 1.0.</p>
<pre class="r"><code>p1 &lt;- ggplot(data=z, 
             aes(x=synth_days, y=after_stat(density))) +
  geom_histogram(color=&quot;grey60&quot;,fill=&quot;cornsilk&quot;,linewidth=0.2) 
print(p1)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="add-empyrical-density-curve---adding-a-kernel-density-plot"
class="section level4">
<h4>Add Empyrical Density Curve - adding a Kernel Density Plot</h4>
<p>This is an empirical curve that is fitted to the data. It does not
assume any particular probability distribution, but it smooths out the
shape of the histogram:</p>
<pre class="r"><code>p1 &lt;-  p1 +  geom_density(linetype=&quot;dotted&quot;,size=0.75)</code></pre>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## â„¹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre class="r"><code>print(p1)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="get-maximum-likelihood-parameters-for-normal-distribution"
class="section level4">
<h4>Get Maximum Likelihood Parameters for Normal distribution</h4>
<p>Next, fit a normal distribution to your data and grab the maximum
likelihood estimators of the two parameters of the normal, the mean and
the variance:</p>
<pre class="r"><code>normPars &lt;- fitdistr(z$synth_days,&quot;normal&quot;)
print(normPars)</code></pre>
<pre><code>##       mean          sd    
##   16.6161790   10.4683832 
##  ( 0.2507442) ( 0.1773029)</code></pre>
<pre class="r"><code>str(normPars)</code></pre>
<pre><code>## List of 5
##  $ estimate: Named num [1:2] 16.6 10.5
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ sd      : Named num [1:2] 0.251 0.177
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ vcov    : num [1:2, 1:2] 0.0629 0 0 0.0314
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ n       : int 1743
##  $ loglik  : num -6566
##  - attr(*, &quot;class&quot;)= chr &quot;fitdistr&quot;</code></pre>
<pre class="r"><code>normPars$estimate[&quot;mean&quot;] # note structure of getting a named attribute</code></pre>
<pre><code>##     mean 
## 16.61618</code></pre>
</div>
<div id="plot-normal-probability-density" class="section level4">
<h4>Plot Normal Probability Density:</h4>
<p>Now letâ€™s call the dnorm function inside ggplotâ€™s stat_function to
generate the probability density for the normal distribution. Read about
stat_function in the help system to see how you can use this to add a
smooth function to any ggplot. Note that we first get the maximum
likelihood parameters for a normal distribution fitted to thse data by
calling fitdistr. Then we pass those parameters (meanML and sdML to
stat_function):</p>
<pre class="r"><code>meanML &lt;- normPars$estimate[&quot;mean&quot;]
sdML &lt;- normPars$estimate[&quot;sd&quot;]

xval &lt;- seq(0,max(z$synth_days),len=length(z$synth_days))

 stat &lt;- stat_function(aes(x = xval, y = ..y..), fun = dnorm, colour=&quot;red&quot;, n = length(z$synth_days), args = list(mean = meanML, sd = sdML))
 p1 + stat</code></pre>
<pre><code>## Warning: The dot-dot notation (`..y..`) was deprecated in ggplot2 3.4.0.
## â„¹ Please use `after_stat(y)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="plot-exponential-probability-density" class="section level4">
<h4>Plot Exponential Probability Density</h4>
<pre class="r"><code>expoPars &lt;- fitdistr(z$synth_days,&quot;exponential&quot;)
rateML &lt;- expoPars$estimate[&quot;rate&quot;]

stat2 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dexp, colour=&quot;blue&quot;, n = length(z$synth_days), args = list(rate=rateML))
 p1 + stat + stat2</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="plot-uniform-probability-density" class="section level4">
<h4>Plot Uniform Probability Density</h4>
<p>For the uniform, we donâ€™t need to use fitdistr because the maximum
likelihood estimators of the two parameters are just the minimum and the
maximum of the data:</p>
<pre class="r"><code>stat3 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dunif, colour=&quot;darkgreen&quot;, n = length(z$synth_days), args = list(min=min(z$synth_days), max=max(z$synth_days)))
 p1 + stat + stat2 + stat3</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="plot-gamma-probability-density" class="section level4">
<h4>Plot Gamma Probability Density</h4>
<pre class="r"><code>gammaPars &lt;- fitdistr(z$synth_days,&quot;gamma&quot;)</code></pre>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<pre class="r"><code>str(z)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1743 obs. of  4 variables:
##  $ wave      : int  1 2 3 4 2 3 4 1 3 3 ...
##  $ iso       : chr  &quot;y&quot; &quot;y&quot; &quot;n&quot; &quot;y&quot; ...
##  $ synth_days: int  20 1 28 24 26 16 1 28 16 8 ...
##  $ subject_id: int  1 1 1 1 2 2 2 3 3 4 ...</code></pre>
<pre class="r"><code>shapeML &lt;- gammaPars$estimate[&quot;shape&quot;]
rateML &lt;- gammaPars$estimate[&quot;rate&quot;]

stat4 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dgamma, colour=&quot;brown&quot;, n = length(z$synth_days), args = list(shape=shapeML, rate=rateML))
 p1 + stat + stat2 + stat3 + stat4</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="plot-beta-probability-density" class="section level4">
<h4>Plot Beta Probability Density</h4>
<p>This one has to be shown in its own plot because the raw data must be
rescaled so they are between 0 and 1, and then they can be compared to
the beta.</p>
<pre class="r"><code>pSpecial &lt;- ggplot(data=z, aes(x=synth_days/(max(synth_days + 0.1)), y=..density..)) +
  geom_histogram(color=&quot;grey60&quot;,fill=&quot;cornsilk&quot;,size=0.2) + 
  xlim(c(0,1)) +
  geom_density(size=0.75,linetype=&quot;dotted&quot;)

betaPars &lt;- fitdistr(x=z$synth_days/max(z$synth_days + 0.1),start=list(shape1=1,shape2=2),&quot;beta&quot;)</code></pre>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<pre class="r"><code>shape1ML &lt;- betaPars$estimate[&quot;shape1&quot;]
shape2ML &lt;- betaPars$estimate[&quot;shape2&quot;]

statSpecial &lt;- stat_function(aes(x = xval, y = ..y..), fun = dbeta, colour=&quot;orchid&quot;, n = length(z$synth_days), args = list(shape1=shape1ML,shape2=shape2ML))
pSpecial + statSpecial</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside the scale range
## (`geom_bar()`).</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div
id="plotting-data-to-distribution-of-best-fit-using-might-be-biased-picking-but-torn-between-norm-and-exponential-so-might-try-both"
class="section level4">
<h4>Plotting data to distribution of best fit using, might be biased
picking, but torn between norm and exponential, so might try both</h4>
<p>Starting first with Normal and comparing to original data</p>
<pre class="r"><code># Starting with Normal Simulated Data, using the mean from normPars from original data
norm_data &lt;- rnorm(n=1743,mean=normPars$estimate[&quot;mean&quot;])
norm_data &lt;- data.frame(1:1743,norm_data)
names(norm_data) &lt;- list(&quot;ID&quot;,&quot;synth_days&quot;)
norm_data &lt;- norm_data[norm_data$synth_days&gt;0,]
str(norm_data)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1743 obs. of  2 variables:
##  $ ID        : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ synth_days: num  16 14.5 16.9 16.8 18.8 ...</code></pre>
<pre class="r"><code>summary(norm_data$synth_days)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   12.88   15.94   16.66   16.65   17.37   19.71</code></pre>
<pre class="r"><code># Gettting new maximum likelihood parameters for new data set
normPars2 &lt;- fitdistr(norm_data$synth_days,&quot;normal&quot;)
print(normPars2)</code></pre>
<pre><code>##       mean           sd     
##   16.64994731    1.03156834 
##  ( 0.02470867) ( 0.01747167)</code></pre>
<pre class="r"><code>str(normPars2)</code></pre>
<pre><code>## List of 5
##  $ estimate: Named num [1:2] 16.65 1.03
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ sd      : Named num [1:2] 0.0247 0.0175
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ vcov    : num [1:2, 1:2] 0.000611 0 0 0.000305
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ n       : int 1743
##  $ loglik  : num -2527
##  - attr(*, &quot;class&quot;)= chr &quot;fitdistr&quot;</code></pre>
<pre class="r"><code>normPars2$estimate[&quot;mean&quot;]</code></pre>
<pre><code>##     mean 
## 16.64995</code></pre>
<pre class="r"><code># Graphing normal distribution
p2 &lt;- ggplot(data=norm_data, 
             aes(x=synth_days, y=after_stat(density))) +
  geom_histogram(color=&quot;grey60&quot;,fill=&quot;cornsilk&quot;,linewidth=0.2) 
print(p2)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>meanML &lt;- normPars2$estimate[&quot;mean&quot;]
sdML &lt;- normPars2$estimate[&quot;sd&quot;]

xval &lt;- seq(0,max(norm_data$synth_days),len=length(norm_data$synth_days))

 stat_1 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dnorm, colour=&quot;red&quot;, n = length(norm_data$synth_days), args = list(mean = meanML, sd = sdML))
 p2 + stat_1</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<pre class="r"><code> p1 + stat</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
<p>Now trying exponential and comparing to original data</p>
<pre class="r"><code># Exp Simulated Data, using the rate from expoPars from original data
exp_data &lt;- rexp(n=1743,rate=expoPars$estimate[&quot;rate&quot;])
exp_data &lt;- data.frame(1:1743,exp_data)
names(exp_data) &lt;- list(&quot;ID&quot;,&quot;synth_days&quot;)
exp_data &lt;- exp_data[exp_data$synth_days&gt;0,]
str(exp_data)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1743 obs. of  2 variables:
##  $ ID        : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ synth_days: num  45 11.52 2.6 12.65 9.16 ...</code></pre>
<pre class="r"><code>summary(exp_data$synth_days)</code></pre>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
##   0.00512   4.48957  10.79958  16.70456  24.05081 135.82258</code></pre>
<pre class="r"><code># Gettting new maximum likelihood parameters for new data set

p3 &lt;- ggplot(data=exp_data, 
             aes(x=synth_days, y=after_stat(density))) +
  geom_histogram(color=&quot;grey60&quot;,fill=&quot;cornsilk&quot;,linewidth=0.2) 
print(p3)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>expoPars2 &lt;- fitdistr(exp_data$synth_days,&quot;exponential&quot;)
rateML2 &lt;- expoPars2$estimate[&quot;rate&quot;]

stat_2 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dexp, colour=&quot;blue&quot;, n = length(z$synth_days), args = list(rate=rateML2))
 p3 + stat_2</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-13-2.png" width="672" /></p>
<pre class="r"><code> p1 + stat2</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="Homework8_files/figure-html/unnamed-chunk-13-3.png" width="672" /></p>
<p>So far, from looking at all these distributions, it seems safe to say
that neither of these are distributions of best fit for the original
data. Exponential predicts into the future, giving us an x axis greater
than the range of days our original data goes. The normal distributions
focuses too much on the average and does not give the proper
acknowledgement of the data towards the end</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
